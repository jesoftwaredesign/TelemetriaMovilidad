!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self)["@influxdata/influxdb-client"]={})}(this,(function(t){"use strict";const e=Object.freeze({retryJitter:200,minRetryDelay:1e3,maxRetryDelay:15e3}),r=Object.freeze(Object.assign({batchSize:1e3,flushInterval:6e4,writeFailed:function(){},maxRetries:2,maxBufferLines:32e3},e)),s=[404,408,425,429,500,502,503,504];function i(t){return s.includes(t)}class n extends Error{constructor(t){super(t),Object.setPrototypeOf(this,n.prototype)}}class o extends Error{constructor(t,e,r,s){super(),this.statusCode=t,this.statusMessage=e,this.body=r,Object.setPrototypeOf(this,o.prototype),this.message=r?`${t} ${e} : ${r}`:`${t} ${e}`,this.setRetryAfter(s)}setRetryAfter(t){"string"==typeof t&&/^[0-9]+$/.test(t)?this._retryAfter=parseInt(t):this._retryAfter=0}canRetry(){return i(this.statusCode)}retryAfter(){return this._retryAfter}}const l=["ECONNRESET","ENOTFOUND","ESOCKETTIMEDOUT","ETIMEDOUT","ECONNREFUSED","EHOSTUNREACH","EPIPE"];function a(t,e){if(t){let r;return"function"==typeof t.retryAfter?t.retryAfter():(r=0,e&&e>0?r+Math.round(Math.random()*e):r)}return 0}class h extends Error{constructor(){super(),Object.setPrototypeOf(this,h.prototype),this.message="Request timed out"}canRetry(){return!0}retryAfter(){return 0}}class c extends Error{constructor(){super(),this.name="AbortError",Object.setPrototypeOf(this,c.prototype),this.message="Response aborted"}canRetry(){return!0}retryAfter(){return 0}}const u=/[-|\\{()[\]^$+*?.]/g;class f{constructor(t,e=""){this.config=t,this.wrap=e;const r=Object.keys(t).join("|").replace(u,"\\$&");this._re=new RegExp("["+r+"]","g")}escape(t){this._re.lastIndex=0;let e=this._re.lastIndex,r="",s=this._re.exec(t);for(;s;){const i=s[0],n=this.config[i].escapeChar,o=this.config[i].replaceChar;r+=t.slice(e,s.index),r+=null!=o?o:n+i,e=this._re.lastIndex,s=this._re.exec(t)}return 0===e?this.wrap+t+this.wrap:e<t.length?this.wrap+r+t.slice(e)+this.wrap:this.wrap+r+this.wrap}}class d{constructor(t,e){this.escapeChar=t,this.replaceChar=e}}const p=new d("\\"),g=t=>t.escape.bind(t),y={measurement:g(new f({",":p," ":p,"\n":new d(void 0,"\\n"),"\r":new d(void 0,"\\r"),"\t":new d(void 0,"\\t")})),quoted:g(new f({'"':p,"\\\\":p},'"')),tag:g(new f({",":p,"=":p," ":p,"\n":new d(void 0,"\\n"),"\r":new d(void 0,"\\r"),"\t":new d(void 0,"\\t")}))};let m=Date.now(),w=0;function b(){{const t=Date.now();t!==m?(m=t,w=0):w++;const e=String(w);return String(t)+"000000000".substr(0,6-e.length)+e}}function x(){return String(Date.now())+"000000000".substr(0,3)}function v(){return String(Date.now())}function O(){return String(Math.floor(Date.now()/1e3))}const S=Object.freeze({[String("s")]:O,[String("ms")]:v,[String("us")]:x,[String("ns")]:b,seconds:O,millis:v,micros:x,nanos:b}),T={[String("s")]:t=>`${Math.floor(t.getTime()/1e3)}`,[String("ms")]:t=>`${t.getTime()}`,[String("us")]:t=>`${t.getTime()}000`,[String("ns")]:t=>`${t.getTime()}000000`},R=t=>t,E={boolean:t=>"true"===t,unsignedLong:R,long:R,double:t=>+t,string:R,base64Binary:R,dateTime:R,duration:R};class C{constructor(t){t.forEach((t,e)=>t.index=e),this.columns=t}column(t){for(let e=0;e<this.columns.length;e++){const r=this.columns[e];if(r.label===t)return r}throw new n(`Column ${t} not found!`)}toObject(t){const e={};for(let r=0;r<this.columns.length&&r<t.length;r++){let s=t[r];const i=this.columns[r];""===s&&i.defaultValue&&(s=i.defaultValue),e[i.label]=(E[i.dataType]||R)(s)}return e}}class ${static from(t){const e=new $;return e.label=t.label,e.dataType=t.dataType,e.group=Boolean(t.group),e.defaultValue=t.defaultValue||"",e}}const _=Symbol("FLUX_VALUE");class j{constructor(t){this.fluxValue=t}toString(){return this.fluxValue}[_](){return this.fluxValue}}function D(t){if(null==t)return"";t=t.toString();let e=void 0,r=0;function s(){void 0===e&&(e=t.substring(0,r))}for(;r<t.length;r++){const i=t.charAt(r);switch(i){case"\r":s(),e+="\\r";break;case"\n":s(),e+="\\n";break;case"\t":s(),e+="\\t";break;case'"':case"\\":s(),e=e+"\\"+i;break;case"$":if(r+1<t.length&&"{"===t.charAt(r+1)){s(),r++,e+="\\${";break}null!=e&&(e+=i);break;default:null!=e&&(e+=i)}}return void 0!==e?e:t}function A(t){const e=String(t);let r=!1;for(const t of e){if("."===t){if(r)throw new Error(`not a flux float: ${e}`);r=!r}if("."!==t&&(t<"0"||t>"9"))throw new Error(`not a flux float: ${e}`)}return e}function L(t){return`regexp.compile(v: "${D(t)}")`}function P(t){return new j(String(t))}function B(t){return void 0===t?"":null===t?"null":"boolean"==typeof t?t.toString():"string"==typeof t?`"${D(t)}"`:"number"==typeof t?A(t):"object"==typeof t&&"function"==typeof t[_]?t[_]():t instanceof Date?t.toISOString():t instanceof RegExp?L(t):B(t.toString())}function k(t,e,r,s){return new(r||(r=Promise))((function(i,n){function o(t){try{a(s.next(t))}catch(t){n(t)}}function l(t){try{a(s.throw(t))}catch(t){n(t)}}function a(t){t.done?i(t.value):new r((function(e){e(t.value)})).then(o,l)}a((s=s.apply(t,e||[])).next())}))}let F=Object.freeze({error(t,e){console.error("ERROR: "+t,e||"")},warn(t,e){console.warn("WARN: "+t,e||"")}});const U={error(t,e){F.error(t,e)},warn(t,e){F.warn(t,e)}};class z{constructor(t){this.options=Object.assign(Object.assign({},e),t),this.success()}nextDelay(t){const e=a(t);return e&&e>0?Math.min(e+Math.round(Math.random()*this.options.retryJitter),this.options.maxRetryDelay):(this.currentDelay?this.currentDelay=Math.min(Math.max(2*this.currentDelay,1)+Math.round(Math.random()*this.options.retryJitter),this.options.maxRetryDelay):this.currentDelay=this.options.minRetryDelay+Math.round(Math.random()*this.options.retryJitter),this.currentDelay)}success(){this.currentDelay=void 0}}class M{constructor(t,e){this.maxLines=t,this.retryLines=e,this.size=0,this.nextRetryTime=0,this.closed=!1,this._timeoutHandle=void 0}addLines(t,e,r){if(this.closed)return;if(!t.length)return;const s=Date.now()+r;if(s>this.nextRetryTime&&(this.nextRetryTime=s),this.first&&this.size+t.length>this.maxLines){const e=this.size,r=.7*e;do{const t=this.first.next;this.size-=this.first.lines.length,this.first=t}while(this.first&&this.size+t.length>r);U.error(`RetryBuffer: ${e-this.size} oldest lines removed to keep buffer size under the limit of ${this.maxLines} lines`)}const i={lines:t,retryCount:e};this.last?(this.last.next=i,this.last=i):(this.first=i,this.last=i,this.scheduleRetry(r)),this.size+=t.length}removeLines(){if(this.first){const t=this.first;return this.first=this.first.next,this.size-=t.lines.length,this.first||(this.last=void 0),t}}scheduleRetry(t){this._timeoutHandle=setTimeout(()=>{const t=this.removeLines();t?this.retryLines(t.lines,t.retryCount).then(()=>{this.scheduleRetry(1)}).catch(t=>{this.scheduleRetry(this.nextRetryTime-Date.now())}):this._timeoutHandle=void 0},t)}flush(){return k(this,void 0,void 0,(function*(){let t;for(;t=this.removeLines();)yield this.retryLines(t.lines,t.retryCount)}))}close(){return this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=void 0),this.closed=!0,this.size}}class H{constructor(t,e,r){this.maxChunkRecords=t,this.flushFn=e,this.scheduleSend=r,this.length=0,this.lines=new Array(t)}add(t){0===this.length&&this.scheduleSend(),this.lines[this.length]=t,this.length++,this.length>=this.maxChunkRecords&&this.flush().catch(t=>{})}flush(){const t=this.reset();return t.length>0?this.flushFn(t):Promise.resolve()}reset(){const t=this.lines.slice(0,this.length);return this.length=0,t}}class I{constructor(t,e,s,i,n){this.transport=t,this.closed=!1,this.sendOptions={method:"POST",headers:{"content-type":"text/plain; charset=utf-8"}},this._timeoutHandle=void 0,this.httpPath=`/api/v2/write?org=${encodeURIComponent(e)}&bucket=${encodeURIComponent(s)}&precision=${i}`,this.writeOptions=Object.assign(Object.assign({},r),n),this.currentTime=S[i],this.dateToProtocolTimestamp=T[i],this.writeOptions.defaultTags&&this.useDefaultTags(this.writeOptions.defaultTags);var o;this.writeBuffer=new H(this.writeOptions.batchSize,t=>(this._clearFlushTimeout(),this.sendBatch(t,this.writeOptions.maxRetries+1)),()=>{this.writeOptions.flushInterval>0&&(this._clearFlushTimeout(),this.closed||(this._timeoutHandle=setTimeout(()=>this.sendBatch(this.writeBuffer.reset(),this.writeOptions.maxRetries+1).catch(t=>{}),this.writeOptions.flushInterval)))}),this.sendBatch=this.sendBatch.bind(this),this.retryStrategy=(o=this.writeOptions,new z(o)),this.retryBuffer=new M(this.writeOptions.maxBufferLines,this.sendBatch)}sendBatch(t,e){const r=this;return!this.closed&&t.length>0?new Promise((s,i)=>{this.transport.send(this.httpPath,t.join("\n"),this.sendOptions,{error(n){const l=r.writeOptions.writeFailed.call(r,n,t,r.writeOptions.maxRetries+2-e);if(l)l.then(s,i);else{if(!r.closed&&e>1&&(!(n instanceof o)||n.statusCode>=429))return U.warn(`Write to influx DB failed (remaining attempts: ${e-1}).`,n),r.retryBuffer.addLines(t,e-1,r.retryStrategy.nextDelay(n)),void i(n);U.error("Write to influx DB failed.",n),i(n)}},complete(){r.retryStrategy.success(),s()}})}):Promise.resolve()}_clearFlushTimeout(){void 0!==this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=void 0)}writeRecord(t){this.writeBuffer.add(t)}writeRecords(t){for(let e=0;e<t.length;e++)this.writeBuffer.add(t[e])}writePoint(t){const e=t.toLineProtocol(this);e&&this.writeBuffer.add(e)}writePoints(t){for(let e=0;e<t.length;e++)this.writePoint(t[e])}flush(){return k(this,void 0,void 0,(function*(){return yield this.writeBuffer.flush(),yield this.retryBuffer.flush()}))}close(){return this.writeBuffer.flush().finally(()=>{const t=this.retryBuffer.close();t&&U.error(`Retry buffer closed with ${t} items that were not written to InfluxDB!`,null),this.closed=!0})}dispose(){this._clearFlushTimeout(),this.closed=!0}useDefaultTags(t){return this.defaultTags=void 0,Object.keys(t).forEach(e=>{(this.defaultTags||(this.defaultTags={}))[e]=y.tag(t[e])}),this}convertTime(t){return void 0===t?this.currentTime():"string"==typeof t?t.length>0?t:void 0:t instanceof Date?this.dateToProtocolTimestamp(t):String("number"==typeof t?Math.floor(t):t)}}const N={concat(t,e){const r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r},toUtf8String(t,e,r){let s,i,n,o,l="",a=e;for(;a<r;)switch(s=t[a++],s>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(s);break;case 12:case 13:i=t[a++],l+=String.fromCharCode((31&s)<<6|63&i);break;case 14:i=t[a++],n=t[a++],l+=String.fromCharCode((15&s)<<12|(63&i)<<6|63&n);break;case 15:i=t[a++],n=t[a++],o=t[a++],l+=String.fromCodePoint((7&s)<<18|(63&i)<<12|(63&n)<<6|63&o)}return l},copy(t,e,r){const s=new Uint8Array(r-e);return s.set(t.slice(e,r)),s}};class V{constructor(t){this.connectionOptions=t,this.chunkCombiner=N,this.defaultHeaders={"content-type":"application/json; charset=utf-8","User-Agent":"influxdb-client-js/1.5.0"},this.connectionOptions.token&&(this.defaultHeaders.Authorization="Token "+this.connectionOptions.token)}send(t,e,r,s){const i=function(t={}){let e=0;return{next:r=>{0===e&&t.next&&null!=r&&t.next(r)},error:r=>{0===e&&(e=1,t.error&&t.error(r))},complete:()=>{0===e&&(e=2,t.complete&&t.complete())},responseStarted:e=>{t.responseStarted&&t.responseStarted(e)}}}(s);if(s&&s.useCancellable&&!r.signal){const t=new AbortController,e=t.signal;s.useCancellable({cancel(){t.abort()},isCancelled:()=>e.aborted})}this.fetch(t,e,r).then(t=>k(this,void 0,void 0,(function*(){if(null==s?void 0:s.responseStarted){const e={};t.headers.forEach((t,r)=>{const s=e[r];void 0===s?e[r]=t:Array.isArray(s)?s.push(t):e[r]=[s,t]}),i.responseStarted(e)}if(t.status>=300)return t.text().then(e=>{if(!e){const r=t.headers.get("x-influxdb-error");r&&(e=r)}i.error(new o(t.status,t.statusText,e,t.headers.get("retry-after")))}).catch(e=>{U.warn("Unable to receive error body",e),i.error(new o(t.status,t.statusText,void 0,t.headers.get("retry-after")))});if(t.body){const e=t.body.getReader();let r;do{r=yield e.read(),i.next(r.value)}while(!r.done)}else if(t.arrayBuffer){const e=yield t.arrayBuffer();i.next(new Uint8Array(e))}else{const e=yield t.text();i.next((new TextEncoder).encode(e))}}))).catch(t=>i.error(t)).finally(()=>i.complete())}request(t,e,r){return k(this,void 0,void 0,(function*(){const s=yield this.fetch(t,e,r),{status:i,headers:n}=s,l=n.get("content-type")||"";let a=void 0;try{l.includes("json")?a=yield s.json():l.includes("text")&&(a=yield s.text())}catch(t){U.warn("Unable to read error body",t)}if(i>=300){if(!a){const t=n.get("x-influxdb-error");t&&(a=t)}throw new o(i,s.statusText,a,s.headers.get("retry-after"))}return a}))}fetch(t,e,r){const{method:s,headers:i}=r,n=
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */
function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(t);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(t,s[i])&&(r[s[i]]=t[s[i]])}return r}(r,["method","headers"]);return fetch(`${this.connectionOptions.url}${t}`,Object.assign({method:s,body:"GET"===s||"HEAD"===s?void 0:"string"==typeof e?e:JSON.stringify(e),headers:Object.assign(Object.assign({},this.defaultHeaders),i),credentials:"omit"},n))}}function q(t,e){return e.toObject(t)}class W{constructor(t,e){this.target=t,this.chunks=e,this.finished=!1}next(t){if(!this.finished)try{this.bufferReceived(t)}catch(t){this.error(t)}}error(t){this.finished||(this.finished=!0,this.target.error(t))}complete(){this.finished||(this.previous&&this.target.next(this.chunks.toUtf8String(this.previous,0,this.previous.length)),this.finished=!0,this.target.complete())}useCancellable(t){this.target.useCancellable&&this.target.useCancellable(t)}bufferReceived(t){let e,r=0;this.previous?(t=this.chunks.concat(this.previous,t),e=this.previous.length):e=0;let s=!1;for(;e<t.length;){const i=t[e];if(10===i){if(!s){const s=e>0&&13===t[e-1]?e-1:e;this.target.next(this.chunks.toUtf8String(t,r,s)),r=e+1}}else 34===i&&(s=!s);e++}this.previous=r<e?this.chunks.copy(t,r,e):void 0}}class J{constructor(){this._reuse=!1}get reuse(){return this._reuse}set reuse(t){t&&!this.reusedValues&&(this.reusedValues=new Array(10)),this._reuse=t}withReuse(){return this.reuse=!0,this}splitLine(t){if(null==t)return this.lastSplitLength=0,[];let e=0,r=0;const s=this._reuse?this.reusedValues:[];let i=0;for(let n=0;n<t.length;n++){const o=t[n];if(","===o){if(e%2==0){const o=this.getValue(t,r,n,e);this._reuse?s[i++]=o:s.push(o),r=n+1,e=0}}else'"'===o&&e++}const n=this.getValue(t,r,t.length,e);return this._reuse?(s[i]=n,this.lastSplitLength=i+1):(s.push(n),this.lastSplitLength=s.length),s}getValue(t,e,r,s){return e===t.length?"":0===s?t.substring(e,r):2===s?t.substring(e+1,r-1):t.substring(e+1,r-1).replace(/""/gi,'"')}}function X(t){const e=(new J).withReuse();let r,s,i=!0,n=0;return{error(e){t.error(e)},next(o){if(""===o)i=!0,r=void 0;else{const l=e.splitLine(o),a=e.lastSplitLength;if(i){if(!r){r=new Array(a);for(let t=0;t<a;t++)r[t]=new $}if(l[0].startsWith("#")){if("#datatype"===l[0])for(let t=1;t<a;t++)r[t].dataType=l[t];else if("#default"===l[0])for(let t=1;t<a;t++)r[t].defaultValue=l[t];else if("#group"===l[0])for(let t=1;t<a;t++)r[t].group="t"===l[t][0]}else{""===l[0]?(n=1,r=r.slice(1)):n=0;for(let t=n;t<a;t++)r[t-n].label=l[t];s=new C(r),i=!1}}else t.next(l.slice(n,a),s)}},complete(){t.complete()},useCancellable(e){t.useCancellable&&t.useCancellable(e)}}}const G="function"==typeof Symbol&&Symbol.observable||"@@observable";class K{constructor(t,e){this.isClosed=!1;try{e({next:e=>{t.next(e)},error:e=>{this.isClosed=!0,t.error(e)},complete:()=>{this.isClosed=!0,t.complete()},useCancellable:t=>{this.cancellable=t}})}catch(e){this.isClosed=!0,t.error(e)}}get closed(){return this.isClosed}unsubscribe(){var t;null===(t=this.cancellable)||void 0===t||t.cancel(),this.isClosed=!0}}function Q(){}class Y{constructor(t,e){this.executor=t,this.decorator=e}subscribe(t,e,r){const s=function(t){const{next:e,error:r,complete:s}=t;return{next:e?e.bind(t):Q,error:r?r.bind(t):Q,complete:s?s.bind(t):Q}}("object"!=typeof t||null===t?{next:t,error:e,complete:r}:t);return new K(this.decorator(s),this.executor)}[G](){return this}}const Z={header:!0,delimiter:",",quoteChar:'"',commentPrefix:"#",annotations:["datatype","group","default"]},tt=t=>t;class et{constructor(t,e){this.transport=t,this.options={org:e}}with(t){return this.options=Object.assign(Object.assign({},this.options),t),this}lines(t){return new Y(this.createExecutor(t),tt)}rows(t){return new Y(this.createExecutor(t),t=>X({next(e,r){t.next({values:e,tableMeta:r})},error(e){t.error(e)},complete(){t.complete()}}))}queryLines(t,e){this.createExecutor(t)(e)}queryRows(t,e){this.createExecutor(t)(X(e))}collectRows(t,e=q){const r=[];return new Promise((s,i)=>{this.queryRows(t,{next(t,s){const i=e.call(this,t,s);void 0!==i&&r.push(i)},error(t){i(t)},complete(){s(r)}})})}collectLines(t){const e=[];return new Promise((r,s)=>{this.queryLines(t,{next(t){e.push(t)},error(t){s(t)},complete(){r(e)}})})}createExecutor(t){const{org:e,type:r,gzip:s}=this.options;return i=>{this.transport.send(`/api/v2/query?org=${encodeURIComponent(e)}`,JSON.stringify(this.decorateRequest({query:t.toString(),dialect:Z,type:r})),{method:"POST",headers:{"content-type":"application/json; encoding=utf-8","accept-encoding":s?"gzip":"identity"}},new W(i,this.transport.chunkCombiner))}}decorateRequest(t){return"function"==typeof this.options.now&&(t.now=this.options.now()),t.type=this.options.type||"flux",t}}t.AbortError=c,t.DEFAULT_ConnectionOptions={timeout:1e4},t.DEFAULT_RetryDelayStrategyOptions=e,t.DEFAULT_WriteOptions=r,t.FLUX_VALUE=_,t.FluxTableColumn=$,t.FluxTableMetaData=C,t.HttpError=o,t.IllegalArgumentError=n,t.InfluxDB=class{constructor(t){if("string"==typeof t)this._options={url:t};else{if(null===t||"object"!=typeof t)throw new n("No url or configuration specified!");this._options=t}const e=this._options.url;if("string"!=typeof e)throw new n("No url specified!");e.endsWith("/")&&(this._options.url=e.substring(0,e.length-1)),this.transport=this._options.transport||new V(this._options)}getWriteApi(t,e,r="ns",s){return new I(this.transport,t,e,r,s||this._options.writeOptions)}getQueryApi(t){return new et(this.transport,t)}},t.Point=class{constructor(t){this.tags={},this.fields={},t&&(this.name=t)}measurement(t){return this.name=t,this}tag(t,e){return this.tags[t]=e,this}booleanField(t,e){return this.fields[t]=e?"T":"F",this}intField(t,e){if("number"!=typeof e){let r;if(isNaN(r=parseInt(String(e))))throw new Error(`Expected integer value for field ${t}, but got '${e}'!`);e=r}return this.fields[t]=`${Math.floor(e)}i`,this}floatField(t,e){if("number"!=typeof e){let r;if(isNaN(r=parseFloat(e)))throw new Error(`Expected float value for field ${t}, but got '${e}'!`);e=r}return this.fields[t]=String(e),this}stringField(t,e){return null!=e&&("string"!=typeof e&&(e=String(e)),this.fields[t]=y.quoted(e)),this}timestamp(t){return this.time=t,this}toLineProtocol(t){if(!this.name)return;let e="";if(Object.keys(this.fields).sort().forEach(t=>{if(t){const r=this.fields[t];e.length>0&&(e+=","),e+=`${y.tag(t)}=${r}`}}),0===e.length)return;let r="";const s=t&&t.defaultTags?Object.assign(Object.assign({},t.defaultTags),this.tags):this.tags;Object.keys(s).sort().forEach(t=>{if(t){const e=s[t];e&&(r+=",",r+=`${y.tag(t)}=${y.tag(e)}`)}});let i=this.time;return t&&t.convertTime&&(i=t.convertTime(i)),`${y.measurement(this.name)}${r} ${e}${void 0!==i?" "+i:""}`}toString(){const t=this.toLineProtocol(void 0);return t||`invalid point: ${JSON.stringify(this,void 0)}`}},t.RequestTimedOutError=h,t.canRetryHttpCall=function(t){return!!t&&("function"==typeof t.canRetry?!!t.canRetry():!(!t.code||!l.includes(t.code)))},t.currentTime=S,t.dateToProtocolTimestamp=T,t.escape=y,t.flux=function(t,...e){if(1==t.length&&(!e||0===e.length))return t[0];const r=new Array(t.length+e.length);let s=0;for(let i=0;i<t.length;i++){const n=t[i];if(r[s++]=n,i<e.length){const o=e[i];let l;if(n.endsWith('"')&&i+1<t.length&&t[i+1].startsWith('"'))l=D(o);else if(l=B(o),""===l)throw new Error(`Unsupported parameter literal '${o}' at index: ${i}, type: ${typeof o}`);r[s++]=l}else if(i<t.length-1)throw new Error("Too few parameters supplied!")}return P(r.join(""))},t.fluxBool=function(t){return new j("true"===t||"false"===t?t:(!!t).toString())},t.fluxDateTime=function(t){return new j(function(t){return`time(v: "${D(t)}")`}(t))},t.fluxDuration=function(t){return new j(`duration(v: "${D(t)}")`)},t.fluxExpression=P,t.fluxFloat=function(t){return new j(A(t))},t.fluxInteger=function(t){const e=String(t);for(const t of e)if(t<"0"||t>"9")throw new Error(`not a flux integer: ${e}`);return new j(e)},t.fluxRegExp=function(t){return new j(L(t))},t.fluxString=function(t){return new j(`"${D(t)}"`)},t.getRetryDelay=a,t.isStatusCodeRetriable=i,t.sanitizeFloat=A,t.toFluxValue=B,t.typeSerializers=E,t.useProcessHrtime=function(t){return!1},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=index.browser.js.map
