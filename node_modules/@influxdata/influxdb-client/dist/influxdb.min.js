var influxdb=function(t){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,r)};function r(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var n=function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function i(t,e,r,n){return new(r||(r=Promise))((function(i,o){function s(t){try{a(n.next(t))}catch(t){o(t)}}function u(t){try{a(n.throw(t))}catch(t){o(t)}}function a(t){t.done?i(t.value):new r((function(e){e(t.value)})).then(s,u)}a((n=n.apply(t,e||[])).next())}))}function o(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}var s=Object.freeze({retryJitter:200,minRetryDelay:1e3,maxRetryDelay:15e3}),u=Object.freeze(n({batchSize:1e3,flushInterval:6e4,writeFailed:function(){},maxRetries:2,maxBufferLines:32e3},s)),a=[404,408,425,429,500,502,503,504];function c(t){return a.includes(t)}var f=function(t){function e(r){var n=t.call(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n}return r(e,t),e}(Error),l=function(t){function e(r,n,i,o){var s=t.call(this)||this;return s.statusCode=r,s.statusMessage=n,s.body=i,Object.setPrototypeOf(s,e.prototype),s.message=i?r+" "+n+" : "+i:r+" "+n,s.setRetryAfter(o),s}return r(e,t),e.prototype.setRetryAfter=function(t){"string"==typeof t&&/^[0-9]+$/.test(t)?this._retryAfter=parseInt(t):this._retryAfter=0},e.prototype.canRetry=function(){return c(this.statusCode)},e.prototype.retryAfter=function(){return this._retryAfter},e}(Error),h=["ECONNRESET","ENOTFOUND","ESOCKETTIMEDOUT","ETIMEDOUT","ECONNREFUSED","EHOSTUNREACH","EPIPE"];function p(t,e){if(t){var r=void 0;return"function"==typeof t.retryAfter?t.retryAfter():(r=0,e&&e>0?r+Math.round(Math.random()*e):r)}return 0}var d,y,g=function(t){function e(){var r=t.call(this)||this;return Object.setPrototypeOf(r,e.prototype),r.message="Request timed out",r}return r(e,t),e.prototype.canRetry=function(){return!0},e.prototype.retryAfter=function(){return 0},e}(Error),v=function(t){function e(){var r=t.call(this)||this;return r.name="AbortError",Object.setPrototypeOf(r,e.prototype),r.message="Response aborted",r}return r(e,t),e.prototype.canRetry=function(){return!0},e.prototype.retryAfter=function(){return 0},e}(Error),m=/[-|\\{()[\]^$+*?.]/g,w=function(){function t(t,e){void 0===e&&(e=""),this.config=t,this.wrap=e;var r=Object.keys(t).join("|").replace(m,"\\$&");this._re=new RegExp("["+r+"]","g")}return t.prototype.escape=function(t){this._re.lastIndex=0;for(var e=this._re.lastIndex,r="",n=this._re.exec(t);n;){var i=n[0],o=this.config[i].escapeChar,s=this.config[i].replaceChar;r+=t.slice(e,n.index),r+=null!=s?s:o+i,e=this._re.lastIndex,n=this._re.exec(t)}return 0===e?this.wrap+t+this.wrap:e<t.length?this.wrap+r+t.slice(e)+this.wrap:this.wrap+r+this.wrap},t}(),b=function(t,e){this.escapeChar=t,this.replaceChar=e},x=new b("\\"),O=function(t){return t.escape.bind(t)},S={measurement:O(new w({",":x," ":x,"\n":new b(void 0,"\\n"),"\r":new b(void 0,"\\r"),"\t":new b(void 0,"\\t")})),quoted:O(new w({'"':x,"\\\\":x},'"')),tag:O(new w({",":x,"=":x," ":x,"\n":new b(void 0,"\\n"),"\r":new b(void 0,"\\r"),"\t":new b(void 0,"\\t")}))};var T=Date.now(),R=0;function E(){var t=Date.now();t!==T?(T=t,R=0):R++;var e=String(R);return String(t)+"000000000".substr(0,6-e.length)+e}function C(){return String(Date.now())+"000000000".substr(0,3)}function _(){return String(Date.now())}function D(){return String(Math.floor(Date.now()/1e3))}var A=Object.freeze(((d={})[String("s")]=D,d[String("ms")]=_,d[String("us")]=C,d[String("ns")]=E,d.seconds=D,d.millis=_,d.micros=C,d.nanos=E,d)),P=((y={})[String("s")]=function(t){return""+Math.floor(t.getTime()/1e3)},y[String("ms")]=function(t){return""+t.getTime()},y[String("us")]=function(t){return t.getTime()+"000"},y[String("ns")]=function(t){return t.getTime()+"000000"},y),j=function(t){return t},L={boolean:function(t){return"true"===t},unsignedLong:j,long:j,double:function(t){return+t},string:j,base64Binary:j,dateTime:j,duration:j},k=function(){function t(t){t.forEach((function(t,e){return t.index=e})),this.columns=t}return t.prototype.column=function(t){for(var e=0;e<this.columns.length;e++){var r=this.columns[e];if(r.label===t)return r}throw new f("Column "+t+" not found!")},t.prototype.toObject=function(t){for(var e={},r=0;r<this.columns.length&&r<t.length;r++){var n=t[r],i=this.columns[r];""===n&&i.defaultValue&&(n=i.defaultValue),e[i.label]=(L[i.dataType]||j)(n)}return e},t}(),B=function(){function t(){}return t.from=function(e){var r=new t;return r.label=e.label,r.dataType=e.dataType,r.group=Boolean(e.group),r.defaultValue=e.defaultValue||"",r},t}(),F=Symbol("FLUX_VALUE"),U=function(){function t(t){this.fluxValue=t}return t.prototype.toString=function(){return this.fluxValue},t.prototype[F]=function(){return this.fluxValue},t}();function z(t){if(null==t)return"";t=t.toString();var e=void 0,r=0;function n(){void 0===e&&(e=t.substring(0,r))}for(;r<t.length;r++){var i=t.charAt(r);switch(i){case"\r":n(),e+="\\r";break;case"\n":n(),e+="\\n";break;case"\t":n(),e+="\\t";break;case'"':case"\\":n(),e=e+"\\"+i;break;case"$":if(r+1<t.length&&"{"===t.charAt(r+1)){n(),r++,e+="\\${";break}null!=e&&(e+=i);break;default:null!=e&&(e+=i)}}return void 0!==e?e:t}function H(t){for(var e=String(t),r=!1,n=0,i=e;n<i.length;n++){var o=i[n];if("."===o){if(r)throw new Error("not a flux float: "+e);r=!r}if("."!==o&&(o<"0"||o>"9"))throw new Error("not a flux float: "+e)}return e}function I(t){return'regexp.compile(v: "'+z(t)+'")'}function M(t){return new U(String(t))}function N(t){return void 0===t?"":null===t?"null":"boolean"==typeof t?t.toString():"string"==typeof t?'"'+z(t)+'"':"number"==typeof t?H(t):"object"==typeof t&&"function"==typeof t[F]?t[F]():t instanceof Date?t.toISOString():t instanceof RegExp?I(t):N(t.toString())}var V=function(){function t(t){this.tags={},this.fields={},t&&(this.name=t)}return t.prototype.measurement=function(t){return this.name=t,this},t.prototype.tag=function(t,e){return this.tags[t]=e,this},t.prototype.booleanField=function(t,e){return this.fields[t]=e?"T":"F",this},t.prototype.intField=function(t,e){if("number"!=typeof e){var r;if(isNaN(r=parseInt(String(e))))throw new Error("Expected integer value for field "+t+", but got '"+e+"'!");e=r}return this.fields[t]=Math.floor(e)+"i",this},t.prototype.floatField=function(t,e){if("number"!=typeof e){var r;if(isNaN(r=parseFloat(e)))throw new Error("Expected float value for field "+t+", but got '"+e+"'!");e=r}return this.fields[t]=String(e),this},t.prototype.stringField=function(t,e){return null!=e&&("string"!=typeof e&&(e=String(e)),this.fields[t]=S.quoted(e)),this},t.prototype.timestamp=function(t){return this.time=t,this},t.prototype.toLineProtocol=function(t){var e=this;if(this.name){var r="";if(Object.keys(this.fields).sort().forEach((function(t){if(t){var n=e.fields[t];r.length>0&&(r+=","),r+=S.tag(t)+"="+n}})),0!==r.length){var i="",o=t&&t.defaultTags?n(n({},t.defaultTags),this.tags):this.tags;Object.keys(o).sort().forEach((function(t){if(t){var e=o[t];e&&(i+=",",i+=S.tag(t)+"="+S.tag(e))}}));var s=this.time;return t&&t.convertTime&&(s=t.convertTime(s)),""+S.measurement(this.name)+i+" "+r+(void 0!==s?" "+s:"")}}},t.prototype.toString=function(){var t=this.toLineProtocol(void 0);return t||"invalid point: "+JSON.stringify(this,void 0)},t}(),q=Object.freeze({error:function(t,e){console.error("ERROR: "+t,e||"")},warn:function(t,e){console.warn("WARN: "+t,e||"")}}),W=function(t,e){q.error(t,e)},J=function(t,e){q.warn(t,e)},$=function(){function t(t){this.options=n(n({},s),t),this.success()}return t.prototype.nextDelay=function(t){var e=p(t);return e&&e>0?Math.min(e+Math.round(Math.random()*this.options.retryJitter),this.options.maxRetryDelay):(this.currentDelay?this.currentDelay=Math.min(Math.max(2*this.currentDelay,1)+Math.round(Math.random()*this.options.retryJitter),this.options.maxRetryDelay):this.currentDelay=this.options.minRetryDelay+Math.round(Math.random()*this.options.retryJitter),this.currentDelay)},t.prototype.success=function(){this.currentDelay=void 0},t}();var G=function(){function t(t,e){this.maxLines=t,this.retryLines=e,this.size=0,this.nextRetryTime=0,this.closed=!1,this._timeoutHandle=void 0}return t.prototype.addLines=function(t,e,r){if(!this.closed&&t.length){var n=Date.now()+r;if(n>this.nextRetryTime&&(this.nextRetryTime=n),this.first&&this.size+t.length>this.maxLines){var i=this.size,o=.7*i;do{var s=this.first.next;this.size-=this.first.lines.length,this.first=s}while(this.first&&this.size+t.length>o);W("RetryBuffer: "+(i-this.size)+" oldest lines removed to keep buffer size under the limit of "+this.maxLines+" lines")}var u={lines:t,retryCount:e};this.last?(this.last.next=u,this.last=u):(this.first=u,this.last=u,this.scheduleRetry(r)),this.size+=t.length}},t.prototype.removeLines=function(){if(this.first){var t=this.first;return this.first=this.first.next,this.size-=t.lines.length,this.first||(this.last=void 0),t}},t.prototype.scheduleRetry=function(t){var e=this;this._timeoutHandle=setTimeout((function(){var t=e.removeLines();t?e.retryLines(t.lines,t.retryCount).then((function(){e.scheduleRetry(1)})).catch((function(t){e.scheduleRetry(e.nextRetryTime-Date.now())})):e._timeoutHandle=void 0}),t)},t.prototype.flush=function(){return i(this,void 0,void 0,(function(){var t;return o(this,(function(e){switch(e.label){case 0:return(t=this.removeLines())?[4,this.retryLines(t.lines,t.retryCount)]:[3,2];case 1:return e.sent(),[3,0];case 2:return[2]}}))}))},t.prototype.close=function(){return this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=void 0),this.closed=!0,this.size},t}(),X=function(){function t(t,e,r){this.maxChunkRecords=t,this.flushFn=e,this.scheduleSend=r,this.length=0,this.lines=new Array(t)}return t.prototype.add=function(t){0===this.length&&this.scheduleSend(),this.lines[this.length]=t,this.length++,this.length>=this.maxChunkRecords&&this.flush().catch((function(t){}))},t.prototype.flush=function(){var t=this.reset();return t.length>0?this.flushFn(t):Promise.resolve()},t.prototype.reset=function(){var t=this.lines.slice(0,this.length);return this.length=0,t},t}(),K=function(){function t(t,e,r,i,o){var s=this;this.transport=t,this.closed=!1,this.sendOptions={method:"POST",headers:{"content-type":"text/plain; charset=utf-8"}},this._timeoutHandle=void 0,this.httpPath="/api/v2/write?org="+encodeURIComponent(e)+"&bucket="+encodeURIComponent(r)+"&precision="+i,this.writeOptions=n(n({},u),o),this.currentTime=A[i],this.dateToProtocolTimestamp=P[i],this.writeOptions.defaultTags&&this.useDefaultTags(this.writeOptions.defaultTags);var a;this.writeBuffer=new X(this.writeOptions.batchSize,(function(t){return s._clearFlushTimeout(),s.sendBatch(t,s.writeOptions.maxRetries+1)}),(function(){s.writeOptions.flushInterval>0&&(s._clearFlushTimeout(),s.closed||(s._timeoutHandle=setTimeout((function(){return s.sendBatch(s.writeBuffer.reset(),s.writeOptions.maxRetries+1).catch((function(t){}))}),s.writeOptions.flushInterval)))})),this.sendBatch=this.sendBatch.bind(this),this.retryStrategy=(a=this.writeOptions,new $(a)),this.retryBuffer=new G(this.writeOptions.maxBufferLines,this.sendBatch)}return t.prototype.sendBatch=function(t,e){var r=this,n=this;return!this.closed&&t.length>0?new Promise((function(i,o){r.transport.send(r.httpPath,t.join("\n"),r.sendOptions,{error:function(r){var s=n.writeOptions.writeFailed.call(n,r,t,n.writeOptions.maxRetries+2-e);if(s)s.then(i,o);else{if(!n.closed&&e>1&&(!(r instanceof l)||r.statusCode>=429))return J("Write to influx DB failed (remaining attempts: "+(e-1)+").",r),n.retryBuffer.addLines(t,e-1,n.retryStrategy.nextDelay(r)),void o(r);W("Write to influx DB failed.",r),o(r)}},complete:function(){n.retryStrategy.success(),i()}})})):Promise.resolve()},t.prototype._clearFlushTimeout=function(){void 0!==this._timeoutHandle&&(clearTimeout(this._timeoutHandle),this._timeoutHandle=void 0)},t.prototype.writeRecord=function(t){this.writeBuffer.add(t)},t.prototype.writeRecords=function(t){for(var e=0;e<t.length;e++)this.writeBuffer.add(t[e])},t.prototype.writePoint=function(t){var e=t.toLineProtocol(this);e&&this.writeBuffer.add(e)},t.prototype.writePoints=function(t){for(var e=0;e<t.length;e++)this.writePoint(t[e])},t.prototype.flush=function(){return i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.writeBuffer.flush()];case 1:return t.sent(),[4,this.retryBuffer.flush()];case 2:return[2,t.sent()]}}))}))},t.prototype.close=function(){var t=this;return this.writeBuffer.flush().finally((function(){var e=t.retryBuffer.close();e&&W("Retry buffer closed with "+e+" items that were not written to InfluxDB!",null),t.closed=!0}))},t.prototype.dispose=function(){this._clearFlushTimeout(),this.closed=!0},t.prototype.useDefaultTags=function(t){var e=this;return this.defaultTags=void 0,Object.keys(t).forEach((function(r){(e.defaultTags||(e.defaultTags={}))[r]=S.tag(t[r])})),this},t.prototype.convertTime=function(t){return void 0===t?this.currentTime():"string"==typeof t?t.length>0?t:void 0:t instanceof Date?this.dateToProtocolTimestamp(t):String("number"==typeof t?Math.floor(t):t)},t}(),Q={concat:function(t,e){var r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r},toUtf8String:function(t,e,r){for(var n,i,o,s,u="",a=e;a<r;)switch((n=t[a++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:u+=String.fromCharCode(n);break;case 12:case 13:i=t[a++],u+=String.fromCharCode((31&n)<<6|63&i);break;case 14:i=t[a++],o=t[a++],u+=String.fromCharCode((15&n)<<12|(63&i)<<6|63&o);break;case 15:i=t[a++],o=t[a++],s=t[a++],u+=String.fromCodePoint((7&n)<<18|(63&i)<<12|(63&o)<<6|63&s)}return u},copy:function(t,e,r){var n=new Uint8Array(r-e);return n.set(t.slice(e,r)),n}};var Y=function(){function t(t){this.connectionOptions=t,this.chunkCombiner=Q,this.defaultHeaders={"content-type":"application/json; charset=utf-8","User-Agent":"influxdb-client-js/1.5.0"},this.connectionOptions.token&&(this.defaultHeaders.Authorization="Token "+this.connectionOptions.token)}return t.prototype.send=function(t,e,r,n){var s=this,u=function(t){void 0===t&&(t={});var e=0;return{next:function(r){0===e&&t.next&&null!=r&&t.next(r)},error:function(r){0===e&&(e=1,t.error&&t.error(r))},complete:function(){0===e&&(e=2,t.complete&&t.complete())},responseStarted:function(e){t.responseStarted&&t.responseStarted(e)}}}(n);if(n&&n.useCancellable&&!r.signal){var a=new AbortController,c=a.signal;n.useCancellable({cancel:function(){a.abort()},isCancelled:function(){return c.aborted}})}this.fetch(t,e,r).then((function(t){return i(s,void 0,void 0,(function(){var e,r,i,s,a;return o(this,(function(o){switch(o.label){case 0:return(null==n?void 0:n.responseStarted)&&(e={},t.headers.forEach((function(t,r){var n=e[r];void 0===n?e[r]=t:Array.isArray(n)?n.push(t):e[r]=[n,t]})),u.responseStarted(e)),t.status>=300?[2,t.text().then((function(e){if(!e){var r=t.headers.get("x-influxdb-error");r&&(e=r)}u.error(new l(t.status,t.statusText,e,t.headers.get("retry-after")))})).catch((function(e){J("Unable to receive error body",e),u.error(new l(t.status,t.statusText,void 0,t.headers.get("retry-after")))}))]:[3,1];case 1:if(!t.body)return[3,6];r=t.body.getReader(),i=void 0,o.label=2;case 2:return[4,r.read()];case 3:i=o.sent(),u.next(i.value),o.label=4;case 4:if(!i.done)return[3,2];o.label=5;case 5:return[3,10];case 6:return t.arrayBuffer?[4,t.arrayBuffer()]:[3,8];case 7:return s=o.sent(),u.next(new Uint8Array(s)),[3,10];case 8:return[4,t.text()];case 9:a=o.sent(),u.next((new TextEncoder).encode(a)),o.label=10;case 10:return[2]}}))}))})).catch((function(t){return u.error(t)})).finally((function(){return u.complete()}))},t.prototype.request=function(t,e,r){return i(this,void 0,void 0,(function(){var n,i,s,u,a,c,f;return o(this,(function(o){switch(o.label){case 0:return[4,this.fetch(t,e,r)];case 1:n=o.sent(),i=n.status,s=n.headers,u=s.get("content-type")||"",a=void 0,o.label=2;case 2:return o.trys.push([2,7,,8]),u.includes("json")?[4,n.json()]:[3,4];case 3:return a=o.sent(),[3,6];case 4:return u.includes("text")?[4,n.text()]:[3,6];case 5:a=o.sent(),o.label=6;case 6:return[3,8];case 7:return c=o.sent(),J("Unable to read error body",c),[3,8];case 8:if(i>=300)throw a||(f=s.get("x-influxdb-error"))&&(a=f),new l(i,n.statusText,a,n.headers.get("retry-after"));return[2,a]}}))}))},t.prototype.fetch=function(t,e,r){var i=r.method,o=r.headers,s=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r}(r,["method","headers"]);return fetch(""+this.connectionOptions.url+t,n({method:i,body:"GET"===i||"HEAD"===i?void 0:"string"==typeof e?e:JSON.stringify(e),headers:n(n({},this.defaultHeaders),o),credentials:"omit"},s))},t}();function Z(t,e){return e.toObject(t)}var tt=function(){function t(t,e){this.target=t,this.chunks=e,this.finished=!1}return t.prototype.next=function(t){if(!this.finished)try{this.bufferReceived(t)}catch(t){this.error(t)}},t.prototype.error=function(t){this.finished||(this.finished=!0,this.target.error(t))},t.prototype.complete=function(){this.finished||(this.previous&&this.target.next(this.chunks.toUtf8String(this.previous,0,this.previous.length)),this.finished=!0,this.target.complete())},t.prototype.useCancellable=function(t){this.target.useCancellable&&this.target.useCancellable(t)},t.prototype.bufferReceived=function(t){var e,r=0;this.previous?(t=this.chunks.concat(this.previous,t),e=this.previous.length):e=0;for(var n=!1;e<t.length;){var i=t[e];if(10===i){if(!n){var o=e>0&&13===t[e-1]?e-1:e;this.target.next(this.chunks.toUtf8String(t,r,o)),r=e+1}}else 34===i&&(n=!n);e++}this.previous=r<e?this.chunks.copy(t,r,e):void 0},t}(),et=function(){function t(){this._reuse=!1}return Object.defineProperty(t.prototype,"reuse",{get:function(){return this._reuse},set:function(t){t&&!this.reusedValues&&(this.reusedValues=new Array(10)),this._reuse=t},enumerable:!0,configurable:!0}),t.prototype.withReuse=function(){return this.reuse=!0,this},t.prototype.splitLine=function(t){if(null==t)return this.lastSplitLength=0,[];for(var e=0,r=0,n=this._reuse?this.reusedValues:[],i=0,o=0;o<t.length;o++){var s=t[o];if(","===s){if(e%2==0){var u=this.getValue(t,r,o,e);this._reuse?n[i++]=u:n.push(u),r=o+1,e=0}}else'"'===s&&e++}var a=this.getValue(t,r,t.length,e);return this._reuse?(n[i]=a,this.lastSplitLength=i+1):(n.push(a),this.lastSplitLength=n.length),n},t.prototype.getValue=function(t,e,r,n){return e===t.length?"":0===n?t.substring(e,r):2===n?t.substring(e+1,r-1):t.substring(e+1,r-1).replace(/""/gi,'"')},t}();function rt(t){var e,r,n=(new et).withReuse(),i=!0,o=0;return{error:function(e){t.error(e)},next:function(s){if(""===s)i=!0,e=void 0;else{var u=n.splitLine(s),a=n.lastSplitLength;if(i){if(!e){e=new Array(a);for(var c=0;c<a;c++)e[c]=new B}if(u[0].startsWith("#")){if("#datatype"===u[0])for(c=1;c<a;c++)e[c].dataType=u[c];else if("#default"===u[0])for(c=1;c<a;c++)e[c].defaultValue=u[c];else if("#group"===u[0])for(c=1;c<a;c++)e[c].group="t"===u[c][0]}else{""===u[0]?(o=1,e=e.slice(1)):o=0;for(var c=o;c<a;c++)e[c-o].label=u[c];r=new k(e),i=!1}}else t.next(u.slice(o,a),r)}},complete:function(){t.complete()},useCancellable:function(e){t.useCancellable&&t.useCancellable(e)}}}var nt="function"==typeof Symbol&&Symbol.observable||"@@observable",it=function(){function t(t,e){var r=this;this.isClosed=!1;try{e({next:function(e){t.next(e)},error:function(e){r.isClosed=!0,t.error(e)},complete:function(){r.isClosed=!0,t.complete()},useCancellable:function(t){r.cancellable=t}})}catch(e){this.isClosed=!0,t.error(e)}}return Object.defineProperty(t.prototype,"closed",{get:function(){return this.isClosed},enumerable:!0,configurable:!0}),t.prototype.unsubscribe=function(){var t;null===(t=this.cancellable)||void 0===t||t.cancel(),this.isClosed=!0},t}();function ot(){}var st=function(){function t(t,e){this.executor=t,this.decorator=e}return t.prototype.subscribe=function(t,e,r){var n=function(t){var e=t.next,r=t.error,n=t.complete;return{next:e?e.bind(t):ot,error:r?r.bind(t):ot,complete:n?n.bind(t):ot}}("object"!=typeof t||null===t?{next:t,error:e,complete:r}:t);return new it(this.decorator(n),this.executor)},t.prototype[nt]=function(){return this},t}(),ut={header:!0,delimiter:",",quoteChar:'"',commentPrefix:"#",annotations:["datatype","group","default"]},at=function(t){return t},ct=function(){function t(t,e){this.transport=t,this.options={org:e}}return t.prototype.with=function(t){return this.options=n(n({},this.options),t),this},t.prototype.lines=function(t){return new st(this.createExecutor(t),at)},t.prototype.rows=function(t){return new st(this.createExecutor(t),(function(t){return rt({next:function(e,r){t.next({values:e,tableMeta:r})},error:function(e){t.error(e)},complete:function(){t.complete()}})}))},t.prototype.queryLines=function(t,e){this.createExecutor(t)(e)},t.prototype.queryRows=function(t,e){this.createExecutor(t)(rt(e))},t.prototype.collectRows=function(t,e){var r=this;void 0===e&&(e=Z);var n=[];return new Promise((function(i,o){r.queryRows(t,{next:function(t,r){var i=e.call(this,t,r);void 0!==i&&n.push(i)},error:function(t){o(t)},complete:function(){i(n)}})}))},t.prototype.collectLines=function(t){var e=this,r=[];return new Promise((function(n,i){e.queryLines(t,{next:function(t){r.push(t)},error:function(t){i(t)},complete:function(){n(r)}})}))},t.prototype.createExecutor=function(t){var e=this,r=this.options,n=r.org,i=r.type,o=r.gzip;return function(r){e.transport.send("/api/v2/query?org="+encodeURIComponent(n),JSON.stringify(e.decorateRequest({query:t.toString(),dialect:ut,type:i})),{method:"POST",headers:{"content-type":"application/json; encoding=utf-8","accept-encoding":o?"gzip":"identity"}},new tt(r,e.transport.chunkCombiner))}},t.prototype.decorateRequest=function(t){return"function"==typeof this.options.now&&(t.now=this.options.now()),t.type=this.options.type||"flux",t},t}(),ft=function(){function t(t){if("string"==typeof t)this._options={url:t};else{if(null===t||"object"!=typeof t)throw new f("No url or configuration specified!");this._options=t}var e=this._options.url;if("string"!=typeof e)throw new f("No url specified!");e.endsWith("/")&&(this._options.url=e.substring(0,e.length-1)),this.transport=this._options.transport||new Y(this._options)}return t.prototype.getWriteApi=function(t,e,r,n){return void 0===r&&(r="ns"),new K(this.transport,t,e,r,n||this._options.writeOptions)},t.prototype.getQueryApi=function(t){return new ct(this.transport,t)},t}();return t.AbortError=v,t.DEFAULT_ConnectionOptions={timeout:1e4},t.DEFAULT_RetryDelayStrategyOptions=s,t.DEFAULT_WriteOptions=u,t.FLUX_VALUE=F,t.FluxTableColumn=B,t.FluxTableMetaData=k,t.HttpError=l,t.IllegalArgumentError=f,t.InfluxDB=ft,t.Point=V,t.RequestTimedOutError=g,t.canRetryHttpCall=function(t){return!!t&&("function"==typeof t.canRetry?!!t.canRetry():!(!t.code||!h.includes(t.code)))},t.currentTime=A,t.dateToProtocolTimestamp=P,t.escape=S,t.flux=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(1==t.length&&(!e||0===e.length))return t[0];for(var n=new Array(t.length+e.length),i=0,o=0;o<t.length;o++){var s=t[o];if(n[i++]=s,o<e.length){var u=e[o],a=void 0;if(s.endsWith('"')&&o+1<t.length&&t[o+1].startsWith('"'))a=z(u);else if(""===(a=N(u)))throw new Error("Unsupported parameter literal '"+u+"' at index: "+o+", type: "+typeof u);n[i++]=a}else if(o<t.length-1)throw new Error("Too few parameters supplied!")}return M(n.join(""))},t.fluxBool=function(t){return new U("true"===t||"false"===t?t:(!!t).toString())},t.fluxDateTime=function(t){return new U(function(t){return'time(v: "'+z(t)+'")'}(t))},t.fluxDuration=function(t){return new U('duration(v: "'+z(t)+'")')},t.fluxExpression=M,t.fluxFloat=function(t){return new U(H(t))},t.fluxInteger=function(t){for(var e=String(t),r=0,n=e;r<n.length;r++){var i=n[r];if(i<"0"||i>"9")throw new Error("not a flux integer: "+e)}return new U(e)},t.fluxRegExp=function(t){return new U(I(t))},t.fluxString=function(t){return new U('"'+z(t)+'"')},t.getRetryDelay=p,t.isStatusCodeRetriable=c,t.sanitizeFloat=H,t.toFluxValue=N,t.typeSerializers=L,t.useProcessHrtime=function(t){return!1},t}({});
//# sourceMappingURL=influxdb.min.js.map
